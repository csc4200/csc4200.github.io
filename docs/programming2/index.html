<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Networking and the Internet</title>
    
<link rel="icon" type="image/png" href="https://tntech-ngin.github.io/csc4200/images/favicon.png" />
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans:400,600" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/csc4200/css/style.min.ffc23d213982a54bd10037c259fdef1df7bcc48e72985ea97b29bf0b53f4e6b8.css" integrity="sha256-/8I9ITmCpUvRADfCWf3vHfe8xI5ymF6peym/C1P05rg=">
<link rel="stylesheet" type="text/css" href="https://tntech-ngin.github.io/csc4200/css/icons.css">

  </head>
  <body>
    
    <div id="preloader">
      <div id="status"></div>
    </div>

    

    



<nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/csc4200">
        <img src="/csc4200/images/logos/logo.svg" alt="" width="112" height="28">
      </a>
      <a class="navbar-item is-hidden-desktop is-hidden-tablet">
        <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

      <div id="navbar-menu" class="navbar-menu is-static">
        <div class="navbar-start">
          <a class="navbar-item is-hidden-mobile">
            <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
              <svg width="1000px" height="1000px">
                <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
                <path class="path2" d="M 300 500 L 700 500"></path>
                <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
              </svg>
              <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
            </div>
          </a>
        </div>

        <div class="navbar-end">
          <a href="/csc4200/syllabus/index.html" class="navbar-item is-secondary">
            Syllabus
          </a>
          <a href="/csc4200/material/index.html" class="navbar-item is-secondary">
            Material
          </a>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Programming Assignments
            </a>

            <div class="navbar-dropdown">
              <a href="/csc4200/programming1/index.html" class="navbar-item">
                Assignment 1
              </a>
              <a href="/csc4200/programming2/index.html" class="navbar-item">
                Assignment 2
              </a>
            </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Homeworks
            </a>

            <div class="navbar-dropdown">
              <a href="/csc4200/homeworks/homework1.pdf" class="navbar-item">
                Homework 1
              </a>
            </div>
          </div>
        </div>
      </div>
  </div>
</nav>





<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/csc4200">
        <img src="/csc4200/images/logos/logo.svg" alt="" width="112" height="28">
      </a>
      <a class="navbar-item is-hidden-desktop is-hidden-tablet">
        <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="cloned-navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="cloned-navbar-menu" class="navbar-menu is-fixed">
      <div class="navbar-start">
        <a class="navbar-item is-hidden-mobile">
          <div id="cloned-menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="cloned-menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
        </a>
      </div>

      <div class="navbar-end">
        <a href="/csc4200/syllabus/index.html" class="navbar-item is-secondary">
          Syllabus
        </a>
        <a href="/csc4200/material/index.html" class="navbar-item is-secondary">
          Material
        </a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Programming Assignments
          </a>

          <div class="navbar-dropdown">
            <a href="/csc4200/programming1/index.html" class="navbar-item">
              Assignment 1
            </a>
            <a href="/csc4200/programming2/index.html" class="navbar-item">
              Assignment 2
            </a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Homeworks
          </a>

          <div class="navbar-dropdown">
            <a href="/csc4200/homeworks/homework1.pdf" class="navbar-item">
              Homework 1
            </a>
          </div>
        </div>
      </div>
    </div>
</div>
</nav>

<section class="section is-medium">
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">To the Cloud and Back</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>
    <h2 id="due-date---march-31-2021-10pm-cst">Due Date - March 31, 2021, 10PM CST</h2>
<hr>
<p><strong>Objectives</strong></p>
<hr>
<p>In this project, you are going to build on the first project. You will have a server in the cloud that downloads and saves a web page in memory. You will then have clients connect to the server and retrives this content. This is the overly simplified idea behind a <strong>WEB PROXY</strong>. The client and server communications MUST use UDP (SOCK_DGRAM) and NOT TCP.</p>
<p>The objectives are:</p>
<p>&ndash; Learn to create robust network protocols</p>
<p>&ndash; Learn about reliable communication</p>
<p>&ndash; How a premitive proxy might work. You can use this to get around sensorship or firewalls.</p>
<hr>
<p><strong>Server Specifications</strong></p>
<hr>
<p>The server (we name it anonserver) takes two arguments:</p>
<pre><code>$ anonserver -p &lt;PORT&gt; -s &lt;LOG FILE LOCATION&gt; -w &lt;web page to download&gt;
</code></pre><p>1.<code>PORT</code> - The port server listens on.</p>
<p>2.<code>Log file location</code> - Where you will keep a record of actions.</p>
<p>3.<code>Web page to download</code> - Which webpage to download and serve.</p>
<p>For example:</p>
<pre><code>$ anonserver -p 30000 -l /tmp/logfile -w www.nytimes.com
</code></pre><p>You can use python URLLIB2 to download the files. Here is a helpful tutorial: <a href="https://docs.python.org/3/howto/urllib2.html">https://docs.python.org/3/howto/urllib2.html</a></p>
<hr>
<p><strong>Server&rsquo;s Functional requirements</strong></p>
<hr>
<ol>
<li>The server must open a UDP socket on the specified port number</li>
<li>The server should gracefully process incorrect port number and exit with a non-zero error code</li>
<li>The server should send a FIN after done sending the packet</li>
<li>The server should download the file specified by -p and serve it from the memory (you don&rsquo;t need to write the retrieved page to a file, just save it to a variable/string)</li>
<li>The server runs indefinitely - it does not exit.</li>
<li>The server accepts connections from multiple clients.</li>
</ol>
<hr>
<p><em><strong>Client Specifications</strong></em></p>
<hr>
<p>The client (we name it anonclient) takes four arguments:
<!-- raw HTML omitted --></p>
<pre><code>$ anonclient -s &lt;SERVER-IP&gt; -p &lt;PORT&gt; -l LOGFILE -f &lt;file_to_write_to&gt;
</code></pre><p>The client takes three arguments:</p>
<p>1.<code>Server IP</code> - The IP address of the anonserver.</p>
<p>2.<code>PORT</code> - The port the server listens on.</p>
<p>2.<code>Log file location</code> - Where you will keep a record of packets you received.</p>
<p>2.<code>File to write to</code> - Where you will write the retrieved content.</p>
<pre><code>For example:
$ anonclient -s 192.168.2.1 -p 6543 -l LOGFILE -f test.txt
</code></pre><!-- raw HTML omitted -->
<hr>
<p><strong>Packet Specification</strong></p>
<hr>
<p>The payload of each UDP packet sent by server and client MUST start with the following 12-byte header. All fields are in network order (most significant bit first):</p>
<pre><code>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                        Sequence Number                        |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                     Acknowledgment Number                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                  Not Used                               |A|S|F|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><p>Where:</p>
<ol>
<li>
<p>Sequence Number (32 bits): The sequence number of the first data octet in this packet (except when SYN is present). If SYN is present the sequence number is the initial sequence number (randomly choosen).</p>
</li>
<li>
<p>Acknowledgement Number (32 bits): <strong>If the ACK control bit is set, this field contains the value of the next sequence number the sender of the segment is expecting to receive. Once a connection is established this is always sent.</strong></p>
</li>
<li>
<p>The acknowledgement number is given in the unit of bytes (how many bytes you have sent)</p>
</li>
<li>
<p>Not Used (29 bits): Must be zero.</p>
</li>
<li>
<p>A (ACK, 1 bit): Indicates that there the value of Acknowledgment Number field is valid</p>
</li>
<li>
<p>S (SYN, 1 bit): Synchronize sequence numbers</p>
</li>
<li>
<p>F (FIN, 1 bit): Finish, No more data from sender</p>
</li>
</ol>
<hr>
<p><strong>This is the protocol you will implement</strong></p>
<hr>
<ol>
<li>
<p>The client opens a UDP socket and initiate 3-way handshake to the specified hostname/ip and port. For an explanation of how a three way handshake works, see the next three steps. Essentially, the client and server will exchange three packets with the following flags sets: (1) SYN (2) SYN|ACK (3)ACK. At the end of the handshake, they will have learned each other&rsquo;s sequence number.</p>
</li>
<li>
<p>Handshake Step 1: <em>Anonclient</em> sends a UDP packet with the following parameters:</p>
</li>
</ol>
<ul>
<li><strong>src-ip=anonclient_IP, src-port=anonclient_port, dst-ip=anonserver_ip, dst-port=anonserver_port, Sequence Number set to 12345 (or chosen randomly), SYN flag set to 1, ACK flag set to 0, FIN flag set to 0</strong>.</li>
</ul>
<ol start="4">
<li>Handshake Step 2:  <em>Anonserver</em> sends a UDP packet with the following parameters:</li>
</ol>
<ul>
<li><strong>src-ip=anonserver_IP, src-port=anonserver_port, dst-ip=anonclient_ip, dst-port=anonclient_port. Sequence Number set to 100 (or chosen randomly), ACK number set to 12346 (Clients seq number + 1) SYN flag set to 1, ACK flag set to 1, FIN flag set to 0</strong>.</li>
</ul>
<ol start="5">
<li>Handshake Step 3:  Anonclient sends a UDP packet with the following parameters:</li>
</ol>
<ul>
<li><strong>src-ip=anonclient_IP, src-port=anonclient_port, dst-ip=anonserver_ip, dst-port=anonserver_port, Sequence Number set to 12346 (ACK from server), ACK number set to 101 (Server seq number + 1), SYN flag set to 0, ACK flag set to 1, FIN flag set to 0</strong>.</li>
</ul>
<ol start="6">
<li>Now both anonclient and anonserver knows each others' sequence numbers and communication can begin. You only perform this handshake once.</li>
<li>Server sends 512 bytes of data in an UDP packet as a payload. It also increases the sequence number  <strong>(seq_to_send = client_seq_received + 1)</strong>, and sets the ACK flag.</li>
<li>The Client acknowledges the number of bytes it received by setting the ACK flag, and adding the number of bytes received to the previous client sequence number <strong>(seq_to_send = server_seq_received + number of bytes received)</strong>.</li>
<li>Upon receiving this ACK, the server creates another packet, sets the ACK flag, updates the sequence number, and sends another 512 bytes.</li>
<li>This interaction continues until all data is sent to the client.</li>
<li>The last packet from the server has the FIN bit set.</li>
<li>The client will send a packet with both FIN and ACK bit set. This completes the data transfer.</li>
<li>Once the interaction is complete, write the retrieved content to a file (on the client side).</li>
</ol>
<p>Here is what a sample interaction looks like:</p>
<pre><code>      Server                                     Client
      |                                            |
      |     seq=12345, ack=0, SYN                  |
      | &lt;------------------------------------------|
      | seq=100,  ack=12346, SYN, ACK              |
      | ----------------------------------------- &gt;|
      |   seq=12346,  ack=101, ACK           	   |
      | &lt;----------------------------------------- |####handshake complete, start getting data
      |seq=101, ack=12347, ACK,512Byte payload 	   |	
      | -----------------------------------------&gt; |
      |   seq=12347, ack=614, ACK            	   |
      | &lt;----------------------------------------- |
      |seq=614,ack=12348,ACK,512Byte payload 	   |
      | ----------------------------------------- &gt;|
      |   seq=12348, ack=1126, ACK           	   |
      | &lt;----------------------------------------- |
      |seq=1126, ack=12349,ACK,512Byte payload	   |
      | ----------------------------------------- &gt;|
      |   seq=12349, ack=1638, ACK           	   |
      | &lt;----------------------------------------- |
      |seq=1638, ack=12350, FIN, payload=5bytes    |
      | -----------------------------------------&gt; |
      |seq=12350, ack=1643, FIN, ACK               |
      | &lt;----------------------------------------- |
</code></pre><hr>
<p><strong>Additional requirements:</strong></p>
<hr>
<ol>
<li>Code must compile/run on Google Cloud Ubuntu VM (18.04) - we will test your code only on the VM.</li>
<li>For each packet received, log both at server and receiver in the following format:</li>
</ol>
<pre><code>&quot;RECV&quot; &lt;Sequence Number&gt; &lt;Acknowledgement Number&gt; [&quot;ACK&quot;] [&quot;SYN&quot;] [&quot;FIN&quot;]
&quot;SEND&quot; &lt;Sequence Number&gt; &lt;Acknowledgement Number&gt; [&quot;ACK&quot;] [&quot;SYN&quot;] [&quot;FIN&quot;]
</code></pre><hr>
<h2 id="hints"><strong>Hints</strong></h2>
<p><code>  def create_packet(**kwargs):</code></p>
<pre><code>data = struct.pack('!I', s_n) #pack the version
....
data += struct.pack(&quot;!c&quot;, ack) #pack the ACK
data += struct.pack(&quot;!c&quot;, syn) #pack the SYN
data += struct.pack(&quot;!c&quot;, fin) #pack the FIN
....
return data    
</code></pre>
<p><code>send_data = create_packet(sequence_number=100, ack_number=0, ack = 'Y', syn = 'N', fin = 'N', payload=data)    </code></p>

  </div>
</section>



    
    <div id="backtotop"><a href="#"></a></div>

    
    
<div class="sidebar">
  <div class="sidebar-header">
    <img src="/csc4200/images/logos/fresh-white-alt.svg">
    <a class="sidebar-close" href="javascript:void(0);">
      <i data-feather="x"></i>
    </a>
  </div>
  <div class="inner">
    <ul class="sidebar-menu">
      
      <li>
        <a href="/csc4200/material/">
          Course Material
        </a>
      </li>
      
      <li>
        <a href="/csc4200/programming3/">
          Create your own content delivery network
        </a>
      </li>
      
      <li>
        <a href="/csc4200/programming1/">
          Programming Assignment
        </a>
      </li>
      
      <li>
        <a href="/csc4200/syllabus/">
          Syllabus
        </a>
      </li>
      
      <li>
        <a href="/csc4200/programming2/">
          To the Cloud and Back
        </a>
      </li>
      
    </ul>
  </div>
</div>

    

    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://unpkg.com/feather-icons"></script>
<script src="https://tntech-ngin.github.io/csc4200/js/fresh.js"></script>
<script src="https://tntech-ngin.github.io/csc4200/js/jquery.panelslider.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  </body>
</html>
