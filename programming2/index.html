<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Networking and the Internet</title>
    
<link rel="icon" type="image/png" href="https://csc4200.github.io/images/favicon.png" />
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans:400,600" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/css/style.min.9bd1e730a56c290ac6b728001ae8cb26269e3ad81e9393854c9d85af485ffcd9.css" integrity="sha256-m9HnMKVsKQrGtygAGujLJiaeOtgek5OFTJ2Fr0hf/Nk=">
<link rel="stylesheet" type="text/css" href="https://csc4200.github.io/css/icons.css">

  </head>
  <body>
    
    <div id="preloader">
      <div id="status"></div>
    </div>

    

    



<nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <img src="/images/logos/logo.svg" alt="" width="112" height="28">
      </a>
      <a class="navbar-item is-hidden-desktop is-hidden-tablet">
        <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

      <div id="navbar-menu" class="navbar-menu is-static">
        <div class="navbar-start">
          <a class="navbar-item is-hidden-mobile">
            <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
              <svg width="1000px" height="1000px">
                <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
                <path class="path2" d="M 300 500 L 700 500"></path>
                <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
              </svg>
              <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
            </div>
          </a>
        </div>

        <div class="navbar-end">
          <a href="/syllabus/index.html" class="navbar-item is-secondary">
            Syllabus
          </a>
          <a href="/material/index.html" class="navbar-item is-secondary">
            Material
          </a>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Programming Assignments
            </a>

            <div class="navbar-dropdown">
              <a href="/programming1/index.html" class="navbar-item">
                Assignment 1
              </a>
              <a href="/" class="navbar-item">
                Assignment 2
              </a>
              <a href="/" class="navbar-item">
                Assignment 3
              </a>
            </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Homeworks
            </a>

            <div class="navbar-dropdown">
              <a href="/homeworks/homework1.pdf" class="navbar-item">
                Homework 1
              </a>
              <a href="/homeworks/homework2.pdf" class="navbar-item">
                Homework 2
              </a>
              <a href="/" class="navbar-item">
                Homework3
              </a>
              <a href="/" class="navbar-item">
                Homework4
              </a>
            </div>
          </div>
        </div>
      </div>
  </div>
</nav>





<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <img src="/images/logos/logo.svg" alt="" width="112" height="28">
      </a>
      <a class="navbar-item is-hidden-desktop is-hidden-tablet">
        <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="cloned-navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="cloned-navbar-menu" class="navbar-menu is-fixed">
      <div class="navbar-start">
        <a class="navbar-item is-hidden-mobile">
          <div id="cloned-menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="cloned-menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
        </a>
      </div>

      <div class="navbar-end">
        <a href="/syllabus/index.html" class="navbar-item is-secondary">
          Syllabus
        </a>
        <a href="/material/index.html" class="navbar-item is-secondary">
          Material
        </a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Programming Assignments
          </a>

          <div class="navbar-dropdown">
            <a href="/programming1/index.html" class="navbar-item">
              Assignment 1
            </a>
            <a href="/" class="navbar-item">
              Assignment 2
            </a>
            <a href="/" class="navbar-item">
              Assignment 3
            </a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Homeworks
          </a>

          <div class="navbar-dropdown">
            <a href="/homeworks/homework1.pdf" class="navbar-item">
              Homework 1
            </a>
            <a href="/homeworks/homework2.pdf" class="navbar-item">
              Homework 2
            </a>
            <a href="/" class="navbar-item">
              Homework3
            </a>
            <a href="/" class="navbar-item">
              Homework4
            </a>
          </div>
        </div>
      </div>
    </div>
</div>
</nav>

<section class="section is-medium">
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">Privately to the Cloud and Back</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>
    

<h2 id="due-date-sept-13-2019">Due Date - Sept 13, 2019</h2>

<hr />

<p><strong>Objectives</strong></p>

<hr />

<ol>
<li><p>Learn to create robust network protocols</p></li>

<li><p>Learn about reliable communication</p></li>

<li><p>How a premitive VPN might work</p></li>
</ol>

<hr />

<p><strong>Overview</strong></p>

<hr />

<p><br></p>

<p>In this project, you are going to build on the first project. You will have a server in the cloud that downloads and saves a web page in memory. You will then have clients that connects to the server and retrives this content. This is the overly simplified idea behind <strong>TOR</strong>. For this project, we are not going to introduce encryption, though this can be easily done later. The client and server communications MUST use UDP (SOCK_DGRAM).
<br></p>

<p><br></p>

<hr />

<p><strong>Server Specifications</strong></p>

<hr />

<p>The server takes two arguments:</p>

<pre><code>$ anonserver -p &lt;PORT&gt; -s &lt;LOG FILE LOCATION&gt; -p &lt;web page to download&gt;
</code></pre>

<p>1.<code>PORT</code> - The port server listens on.</p>

<p>2.<code>Log file location</code> - Where you will keep a record of actions.</p>

<p>3.<code>p</code> - Which webpage to download and serve</p>

<p>For example:</p>

<pre><code>$ anonserver -p 30000 -l /tmp/logfile -p www.nytimes.com
</code></pre>

<hr />

<p>Functional requirements</p>

<hr />

<ol>
<li><p>The server must open a UDP socket on the specified port number</p></li>

<li><p>The server should gracefully process incorrect port number and exit with a non-zero error code</p></li>

<li><p>The server should send a FIN after done sending the packet</p></li>

<li><p>The server should download the file specified by -p and save it from the memory</p></li>
</ol>

<hr />

<p><strong><em>Client Specifications</em></strong></p>

<hr />

<p><br></p>

<pre><code>$ anonclient -s &lt;SERVER-IP&gt; -p &lt;PORT&gt; -l LOGFILE
</code></pre>

<p>The client takes three arguments:</p>

<p>1.<code>Server IP</code> - The IP address of the server.</p>

<p>2.<code>PORT</code> - The port the server listens on.</p>

<p>2.<code>Log file location</code> - Where you will keep a record of packets you received.</p>

<pre><code>For example:
$ anonclient -s 192.168.2.1 -p 6543 -l LOGFILE
</code></pre>

<hr />

<p>Protocol Specifications</p>

<hr />

<p>The payload of each UDP packet sent by server and client MUST start with the following 12-byte header. All fields are in network order (most significant bit first):</p>

<pre><code>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                        Sequence Number                        |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                     Acknowledgment Number                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                  Not Used                               |A|S|F|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<p>Where:</p>

<pre><code>1. Sequence Number (32 bits): The sequence number of the first data octet in this packet (except when SYN is present). If SYN is present the sequence number is the initial sequence number (100).
2. The sequence number is given in the unit of bytes in the packet.

3. Acknowledgement Number (32 bits): If the ACK control bit is set this field contains the value of the next sequence number the sender of the segment is expecting to receive. Once a connection is established this is always sent.

4. The acknowledgement number is given in the unit of bytes.

6. Not Used (29 bits): Must be zero.

7. A (ACK, 1 bit): Indicates that there the value of Acknowledgment Number field is valid

8. S (SYN, 1 bit): Synchronize sequence numbers

9. F (FIN, 1 bit): Finish, No more data from sender
</code></pre>

<pre><code>      Server                                Client
      |                                     |
      |     seq=12345, ack=0, SYN           |
      | &lt;---------------------------------- |
      | seq=100,  ack=12346, SYN, ACK       |
      | ----------------------------------&gt; |
      |   seq=12346,  ack=101, ACK          |
      | &lt;---------------------------------- |####handshake complete, start getting data
      |seq=102, ack=12347, ACK, 512 payload |
      | ----------------------------------&gt; |
      |   seq=12347, ack=614, ACK           |
      | &lt;---------------------------------- |
      |seq=614, ack=12348, ACK, 512 payload|
      | ----------------------------------&gt; |
      |   seq=12348, ack=1126, ACK          |
      | &lt;---------------------------------- |
      |   seq=4322, ack=13370,  ACK         |
      | ----------------------------------&gt; |


</code></pre>

<p>Client requirements:</p>

<ol>
<li>The client must open a UDP socket and initiate 3-way handshake to the specified hostname/ip and port</li>
<li>Send UDP packet src-ip=DEFAULT, src-port=DEFAULT, dst-ip=HOSTNAME-OR-IP, dst-port=PORT with SYN flag set, Connection ID initialized to 0, Sequence Number set to 12345, and Acknowledgement Number set to 0</li>
<li>Expect response from server with SYN | ACK flags.</li>
<li>Send UDP packet with ACK flag, you should now start receiving data</li>
<li>The client should gracefully process incorrect hostname and port number and exit with a non-zero exit code</li>
<li>After file is successfully transferred, expect a FIN message from the server</li>
<li>On a FIN message, send an FIN|ACK, and gracefully shutdown the connection and write the content to an output file</li>
<li>You can assume no packet loss for this</li>
</ol>

<hr />

<p><strong><em>Deliverables (each worth 5 points)</em></strong></p>

<hr />

<ol>
<li><p>Write a server that listens for incoming connections on the specified port.</p></li>

<li><p>Server must parse two command line arguments, port and log locations.</p></li>

<li><p>The server must <em>not</em> exit after receiving a single packet.</p></li>

<li><p>Once a client connects, it logs a message in the following format <code>&quot;Received connection from &lt;CLIENT IP, PORT&gt; &quot;</code></p></li>

<li><p>Once it receives a hello message from the client, it logs the connection and sends a hello back to the client.</p></li>

<li><p>You can assume the packet format is the following:</p>

<pre><code>+-----------------+--------------------------+-------------------------+
|                 |                          |                         |
|                 |                          |                         |
|Version(4 bytes) |Message type (4 bytes)    |Message Length (4 bytes) |
|                 |                          |                         |
|                 |                          |                         |
+-----------------+--------------------------+-------------------------+
|                                                                      |
|                                                                      |
|                       Message (Max 8 Bytes)                          |
|                                                                      |
|                                                                      |
+----------------------------------------------------------------------+
</code></pre></li>

<li><p>It receives the packet header first, followed by the message. <em>Hint: You need two RECV calls</em>.</p></li>

<li><p>Check if Version == 17. If not, log an error message <code>VERSION MISMATCH</code> and continue to listen. Do not exit.</p></li>

<li><p>If Version == 17, check the message type. If message Type is 1 - the corresponding command is <code>LIGHTON</code>. If message type is 2 - the corresponding command is <code>LIGHTOFF</code>. No other command is supported.</p></li>

<li><p>If the server sees a supported command, log &ldquo;EXECUTING SUPPORTED COMMAND: COMMANDNAME&rdquo;, else log &lt;&ldquo;IGNORING UNKNOWN COMMAND: COMMANDNAME&rdquo;.</p></li>

<li><p>Send back a &ldquo;SUCCESS&rdquo; message to the client.</p></li>

<li><p>Make sure server does not exit on 0 byte messages.
<br></p></li>
</ol>

<p><br></p>

<hr />

<p><strong><em>Client Requirements (each worth 5 points, item 9 is worth 10 points)</em></strong></p>

<hr />

<p><br></p>

<ol>
<li><p>The client must parse three command line arguments, server, port, and logfile.</p></li>

<li><p>The client should connect to the server on the specified port.</p></li>

<li><p>Constructs and sends a hello packet to the server.</p>

<pre><code>+-----------------+--------------------------+-------------------------+
|                 |                          |                         |
|                 |                          |                         |
|Version(4 bytes) |Message type (4 bytes)    |Message Length (4 bytes) |
|                 |                          |                         |
|                 |                          |                         |
+-----------------+--------------------------+-------------------------+
|                                                                      |
|                                                                      |
|                       Message (HELLO)                                |
|                                                                      |
|                                                                      |
+----------------------------------------------------------------------+
</code></pre></li>

<li><p>Receive reply from Server - if version is 17, log &ldquo;VERSION ACCEPTED&rdquo;, else log - &ldquo;VERSION MISMATCH&rdquo;</p></li>

<li><p>If version is accepted, send a command packet.</p>

<pre><code>+-----------------+--------------------------+-------------------------+
|                 |                          |                         |
|                 |                          |                         |
|Version(4 bytes) |Message type (4 bytes)    |Message Length (4 bytes) |
|                 |                          |                         |
|                 |                          |                         |
+-----------------+--------------------------+-------------------------+
|                                                                      |
|                                                                      |
|                       COMMAND (LIGHTON/LIGHTOFF)                     |
|                                                                      |
|                                                                      |
+----------------------------------------------------------------------+
</code></pre></li>

<li><p>Receive the server&rsquo;s reply, log the reply, and gracefully shutdown the socket. You can assume the server always replies with a &ldquo;SUCCESS&rdquo; message for this assignment.</p></li>

<li><p>Use TCPDUMP or Wireshark to capture the interactions, turn the .pcap file in with the assignment.</p></li>
</ol>

<p><br></p>

<hr />

<p>Additional requirements:</p>

<hr />

<ol>
<li><p>Code must compile/run on Google Cloud Ubuntu VM (18.04) - we will test your code only on the VM.</p></li>

<li><p>You must pack the packet in a structure. If you are using python, use the struct module.</p></li>

<li><p>Pay extra attention to byte-order encoding before sending the packet. Big-endianness is the dominant ordering in today&rsquo;s network protocols.</p></li>
</ol>

  </div>
</section>



    
    <div id="backtotop"><a href="#"></a></div>

    
    
<div class="sidebar">
  <div class="sidebar-header">
    <img src="/images/logos/fresh-white-alt.svg">
    <a class="sidebar-close" href="javascript:void(0);">
      <i data-feather="x"></i>
    </a>
  </div>
  <div class="inner">
    <ul class="sidebar-menu">
      
      <li>
        <a href="/material/">
          Course Material
        </a>
      </li>
      
      <li>
        <a href="/programming2/">
          Privately to the Cloud and Back
        </a>
      </li>
      
      <li>
        <a href="/programming1/">
          Programming Assignment
        </a>
      </li>
      
      <li>
        <a href="/syllabus/">
          Syllabus
        </a>
      </li>
      
    </ul>
  </div>
</div>

    

    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://unpkg.com/feather-icons"></script>
<script src="https://csc4200.github.io/js/fresh.js"></script>
<script src="https://csc4200.github.io/js/jquery.panelslider.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  </body>
</html>
